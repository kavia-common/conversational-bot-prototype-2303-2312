{"is_source_file": true, "format": "JavaScript (React Hooks)", "description": "This source file defines a React hook called useApiClient that provides functions for interacting with a backend API or a local fallback to generate website content based on user prompts. It handles sending messages, streaming message responses, and managing environment configurations for API endpoints and WebSocket URLs, with fallback implementations for local content generation.", "external_files": ["../utils/generation", "../utils/env"], "external_methods": ["generateSiteFromPrompt", "sanitizeGeneratedHtml", "env()"], "published": ["useApiClient"], "classes": [], "methods": [{"name": "useApiClient()", "description": "Main hook function that returns helper functions for message sending and streaming, as well as environment info.", "scope": "", "scopeKind": ""}, {"name": "localSendMessage(messages)", "description": "Fallback implementation that generates content locally based on user prompts.", "scope": "useApiClient", "scopeKind": "function"}, {"name": "localStreamMessage(messages, onDelta)", "description": "Simulates streaming assistant responses locally by emitting partial content deltas.", "scope": "useApiClient", "scopeKind": "function"}, {"name": "apiSendMessage(messages)", "description": "Sends a message to the backend API and processes the response.", "scope": "useApiClient", "scopeKind": "function"}, {"name": "apiStreamMessage(messages, onDelta)", "description": "Attempts to stream assistant responses via WebSocket or falls back to server-sent events, with local fallback.", "scope": "useApiClient", "scopeKind": "function"}, {"name": "readSettings()", "description": "Reads configuration settings from local storage.", "scope": "useApiClient", "scopeKind": "function"}, {"name": "s()", "scope": "useApiClient.apiStreamMessage", "scopeKind": "function", "description": "unavailable"}], "calls": ["generateSiteFromPrompt", "sanitizeGeneratedHtml", "window.localStorage.getItem", "fetch", "JSON.parse", "JSON.stringify", "setTimeout", "WebSocket", "ws.send", "ws.close"], "search-terms": ["useApiClient", "streamMessage", "generateSiteFromPrompt", "sanitizeGeneratedHtml", "REACT_APP_API_BASE", "REACT_APP_WS_URL", "fallback", "local generation", "WebSocket stream"], "state": 2, "file_id": 22, "knowledge_revision": 194, "git_revision": "ae6c62077fdd1f368c8950dbce8cc4f39a4d7623", "revision_history": [{"77": ""}, {"144": "a7000a4715c6d47c7bc200b254acaecb054b189f"}, {"145": "a7000a4715c6d47c7bc200b254acaecb054b189f"}, {"146": "a7000a4715c6d47c7bc200b254acaecb054b189f"}, {"160": "e325a49d94ca5a138cd13e52506ea607a732d156"}, {"161": "e325a49d94ca5a138cd13e52506ea607a732d156"}, {"175": "e2ee0d0e660f78b98c122c88ebd298934f53f85c"}, {"190": "e2ee0d0e660f78b98c122c88ebd298934f53f85c"}, {"191": "e2ee0d0e660f78b98c122c88ebd298934f53f85c"}, {"194": "ae6c62077fdd1f368c8950dbce8cc4f39a4d7623"}], "ctags": [{"_type": "tag", "name": "Accept", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      const headers = { Accept: 'text\\/event-stream', 'Content-Type': 'application\\/json' };$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiStreamMessage.headers", "scopeKind": "class"}, {"_type": "tag", "name": "Content-Type", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      const headers = { 'Content-Type': 'application\\/json' };$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiSendMessage.headers", "scopeKind": "class"}, {"_type": "tag", "name": "Content-Type", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      const headers = { Accept: 'text\\/event-stream', 'Content-Type': 'application\\/json' };$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiStreamMessage.headers", "scopeKind": "class"}, {"_type": "tag", "name": "apiSendMessage", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^  async function apiSendMessage(messages) {$/", "language": "JavaScript", "kind": "function", "signature": "(messages)", "scope": "useApiClient", "scopeKind": "function"}, {"_type": "tag", "name": "apiStreamMessage", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^  async function apiStreamMessage(messages, onDelta) {$/", "language": "JavaScript", "kind": "function", "signature": "(messages, onDelta)", "scope": "useApiClient", "scopeKind": "function"}, {"_type": "tag", "name": "assistantMsg", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^    const assistantMsg = {$/", "language": "JavaScript", "kind": "class", "scope": "useApiClient.localSendMessage", "scopeKind": "class"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^            content:$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      content:$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.localSendMessage.assistantMsg", "scopeKind": "class"}, {"_type": "tag", "name": "done", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^            done: true,$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class"}, {"_type": "tag", "name": "finalMsg", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^          const finalMsg = {$/", "language": "JavaScript", "kind": "class", "scope": "useApiClient.apiStreamMessage", "scopeKind": "class"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      const headers = { 'Content-Type': 'application\\/json' };$/", "language": "JavaScript", "kind": "class", "scope": "useApiClient.apiSendMessage", "scopeKind": "class"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      const headers = { Accept: 'text\\/event-stream', 'Content-Type': 'application\\/json' };$/", "language": "JavaScript", "kind": "class", "scope": "useApiClient.apiStreamMessage", "scopeKind": "class"}, {"_type": "tag", "name": "html", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^            html: typeof data?.html === 'string' ? data.html : ''$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class"}, {"_type": "tag", "name": "localSendMessage", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^  async function localSendMessage(messages) {$/", "language": "JavaScript", "kind": "function", "signature": "(messages)", "scope": "useApiClient", "scopeKind": "function"}, {"_type": "tag", "name": "localStreamMessage", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^  async function localStreamMessage(messages, onDelta) {$/", "language": "JavaScript", "kind": "function", "signature": "(messages, onDelta)", "scope": "useApiClient", "scopeKind": "function"}, {"_type": "tag", "name": "readSettings", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^  function readSettings() {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "useApiClient", "scopeKind": "function"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^            role: 'assistant',$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      role: 'assistant',$/", "language": "JavaScript", "kind": "property", "scope": "useApiClient.localSendMessage.assistantMsg", "scopeKind": "class"}, {"_type": "tag", "name": "s", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^      const s = (function () {$/", "language": "JavaScript", "kind": "function", "signature": "()", "scope": "useApiClient.apiStreamMessage", "scopeKind": "function"}, {"_type": "tag", "name": "useApiClient", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/frontend_reactjs/src/hooks/useApiClient.js", "pattern": "/^export default function useApiClient() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}], "hash": "a794b876385f2da9d8be4ba08b569fa9", "format-version": 4, "code-base-name": "frontend_reactjs", "filename": "frontend_reactjs/src/hooks/useApiClient.js", "fields": [{"name": "const headers = { Accept: 'text\\/event-stream', 'Content-Type': 'application\\/json' };", "scope": "useApiClient.apiStreamMessage.headers", "scopeKind": "class", "description": "unavailable"}, {"name": "const headers = { 'Content-Type': 'application\\/json' };", "scope": "useApiClient.apiSendMessage.headers", "scopeKind": "class", "description": "unavailable"}, {"name": "content:", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class", "description": "unavailable"}, {"name": "done: true,", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class", "description": "unavailable"}, {"name": "html: typeof data?.html === 'string' ? data.html : ''", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class", "description": "unavailable"}, {"name": "role: 'assistant',", "scope": "useApiClient.apiStreamMessage.finalMsg", "scopeKind": "class", "description": "unavailable"}]}