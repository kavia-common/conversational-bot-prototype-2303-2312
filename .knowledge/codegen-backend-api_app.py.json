{"is_source_file": true, "format": "Python", "description": "This file implements a FastAPI web server providing an API for generating HTML content via multiple AI providers (Ollama and OpenAI). It exposes endpoints for prompt-based HTML generation, handles provider selection, SSE streaming, and manages environmental configurations.", "external_files": ["fastapi", "fastapi.responses", "pydantic", "dotenv", "httpx"], "external_methods": ["FastAPI", "Header", "Request", "Response", "JSONResponse", "StreamingResponse", "BaseModel", "Field", "load_dotenv", "httpx.AsyncClient", "async def", "json.dumps"], "published": ["app", "GenerateBody", "generate"], "classes": [{"name": "GenerateBody", "description": "Pydantic model defining the request body schema for generation requests, including prompt, provider, and model parameters."}], "methods": [{"name": "Optional[str] env(name: str, default: Optional[str] = None)", "description": "Utility function to fetch environment variables with optional default fallback.", "scope": "", "scopeKind": ""}, {"name": "str redact(msg: str)", "description": "Sanitizes error messages by replacing sensitive API keys with a placeholder.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] ollama_adapter( prompt: str, model: Optional[str], base_url: Optional[str] )", "description": "Makes an HTTP request to the Ollama API to generate HTML content based on a prompt.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] openai_adapter(prompt: str, model: Optional[str], api_key: Optional[str])", "description": "Calls the OpenAI Chat Completions API to generate HTML content from a prompt.", "scope": "", "scopeKind": ""}, {"name": "str pick_provider(req_provider: Optional[str])", "description": "Determines which provider ('openai' or 'ollama') to use based on user input or environment settings.", "scope": "", "scopeKind": ""}, {"name": "bool want_sse(request: Request)", "description": "Checks if the client request prefers Server-Sent Events (SSE) streaming.", "scope": "", "scopeKind": ""}, {"name": "bytes sse_event(event: str, data: str)", "description": "Formats a string as an SSE data message.", "scope": "", "scopeKind": ""}, {"name": "generate( request: Request, body: GenerateBody, x_ollama_base: Optional[str] = Header(None, alias=\"X-Ollama-Base\"), x_openai_key: Optional[str] = Header(None, alias=\"X-OpenAI-Key\"), )", "description": "API endpoint to handle generation requests, supporting both JSON responses and SSE streams, based on client headers.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] _do_call()", "scope": "generate", "scopeKind": "function", "description": "unavailable"}, {"name": "AsyncGenerator[bytes,None] sse_stream()", "scope": "generate", "scopeKind": "function", "description": "unavailable"}], "calls": ["httpx.AsyncClient.post", "json.dumps"], "search-terms": ["FastAPI", "HTML generation API", "OpenAI Chat API", "Ollama AI API", "SSE streaming", "prompt", "provider selection", "environment variables", "generate endpoint", "AI model configuration"], "state": 2, "file_id": 35, "knowledge_revision": 150, "git_revision": "", "ctags": [{"_type": "tag", "name": "APP_DESC", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^APP_DESC = \"Proxy generation to local Ollama or OpenAI Chat Completions with simple SSE.\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "APP_TITLE", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^APP_TITLE = \"CodeGen Backend API\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "APP_VERSION", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^APP_VERSION = \"0.1.0\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "GenerateBody", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^class GenerateBody(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_do_call", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^    async def _do_call() -> Dict[str, Any]:$/", "file": true, "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "()", "scope": "generate", "scopeKind": "function"}, {"_type": "tag", "name": "_json", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^                import json as _json$/", "file": true, "language": "Python", "kind": "namespace", "scope": "generate.sse_stream", "scopeKind": "function", "nameref": "module:json"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "env", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^def env(name: str, default: Optional[str] = None) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(name: str, default: Optional[str] = None)"}, {"_type": "tag", "name": "generate", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^async def generate($/", "language": "Python", "kind": "function", "signature": "( request: Request, body: GenerateBody, x_ollama_base: Optional[str] = Header(None, alias=\"X-Ollama-Base\"), x_openai_key: Optional[str] = Header(None, alias=\"X-OpenAI-Key\"), )"}, {"_type": "tag", "name": "model", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^    model: Optional[str] = Field(None, description=\"Model name for chosen provider\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "GenerateBody", "scopeKind": "class"}, {"_type": "tag", "name": "ollama_adapter", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^async def ollama_adapter($/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "( prompt: str, model: Optional[str], base_url: Optional[str] )"}, {"_type": "tag", "name": "openai_adapter", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^async def openai_adapter(prompt: str, model: Optional[str], api_key: Optional[str]) -> Dict[str,/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(prompt: str, model: Optional[str], api_key: Optional[str])"}, {"_type": "tag", "name": "pick_provider", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^def pick_provider(req_provider: Optional[str]) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(req_provider: Optional[str])"}, {"_type": "tag", "name": "prompt", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^    prompt: str = Field(..., description=\"User prompt for page generation\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "GenerateBody", "scopeKind": "class"}, {"_type": "tag", "name": "provider", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^    provider: Optional[str] = Field(None, description=\"'ollama' | 'openai'\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "GenerateBody", "scopeKind": "class"}, {"_type": "tag", "name": "redact", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^def redact(msg: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(msg: str)"}, {"_type": "tag", "name": "sse_event", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^def sse_event(event: str, data: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(event: str, data: str)"}, {"_type": "tag", "name": "sse_stream", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^        async def sse_stream() -> AsyncGenerator[bytes, None]:$/", "file": true, "language": "Python", "typeref": "typename:AsyncGenerator[bytes,None]", "kind": "function", "signature": "()", "scope": "generate", "scopeKind": "function"}, {"_type": "tag", "name": "want_sse", "path": "/home/kavia/workspace/code-generation/conversational-bot-prototype-2303-2312/codegen-backend-api/app.py", "pattern": "/^def want_sse(request: Request) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(request: Request)"}], "hash": "9d170c9fb4150ee712545bfdb49edfe4", "format-version": 4, "code-base-name": "frontend_reactjs", "filename": "codegen-backend-api/app.py", "fields": [{"name": "APP_DESC = \"Proxy generation to local Ollama or OpenAI Chat Completions with simple SSE.\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "APP_TITLE = \"CodeGen Backend API\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "APP_VERSION = \"0.1.0\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] model", "scope": "GenerateBody", "scopeKind": "class", "description": "unavailable"}, {"name": "str prompt", "scope": "GenerateBody", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] provider", "scope": "GenerateBody", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"150": ""}]}